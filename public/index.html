<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Phrase Bingo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind (CDN) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- App styles -->
    <link rel="stylesheet" href="/styles.css" />
    <!-- Tiny inline favicon to avoid 404s -->
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='64' width='64' viewBox='0 0 64 64'%3E%3Crect rx='12' ry='12' width='64' height='64' fill='%23596aff'/%3E%3Ctext x='50%25' y='56%25' text-anchor='middle' font-size='36' fill='white'%3EB%3C/text%3E%3C/svg%3E" />
</head>
<body class="bg-gradient-to-br from-slate-50 via-indigo-50 to-sky-50 text-slate-900 min-h-screen">
<div id="app" class="min-h-screen">
    <!-- Login -->
    <div id="loginPanel" class="max-w-md mx-auto mt-24 p-6 bg-white/80 backdrop-blur rounded-2xl shadow-xl border border-slate-200 animate-fade-in">
        <div class="flex items-center gap-3 mb-4">
            <div class="h-10 w-10 rounded-xl bg-indigo-600/90 flex items-center justify-center text-white text-xl">B</div>
            <h1 class="text-2xl font-semibold tracking-tight">Join Phrase Bingo</h1>
        </div>
        <p class="text-sm text-slate-500 mb-4">Enter a display name (no account needed).</p>
        <form id="loginForm" class="space-y-3">
            <label for="displayName"></label><input id="displayName" type="text" required maxlength="40"
                                                    placeholder="Your name"
                                                    class="w-full border rounded-xl px-4 py-2 focus:outline-none focus:ring focus:ring-indigo-200 transition"/>
            <button class="w-full bg-indigo-600 text-white rounded-xl py-2 hover:bg-indigo-700 transition active:scale-[.99] ripple">
                Enter
            </button>
        </form>
    </div>

    <!-- Main -->
    <div id="mainPanel" class="hidden max-w-7xl mx-auto p-4 animate-fade-in">
        <div class="flex items-center justify-between mb-4">
            <div class="flex items-center gap-3">
                <div class="h-9 w-9 rounded-xl bg-indigo-600 text-white flex items-center justify-center font-extrabold">B</div>
                <h2 class="text-xl font-semibold">Welcome, <span id="whoami"></span></h2>
                <span id="seedDate" class="text-xs px-2 py-1 rounded-full border border-slate-200 text-slate-600 bg-white/70 ml-1"></span>
            </div>
            <button id="switchUser" class="text-sm px-3 py-2 border rounded-xl hover:bg-slate-100 transition ripple">Switch</button>
        </div>

        <!-- 12-col layout -->
        <div class="grid grid-cols-1 xl:grid-cols-12 gap-6 items-start">
            <!-- LEFT: Players + Bingo Calls -->
            <aside class="xl:col-span-3 space-y-4">
                <section class="panel">
                    <div class="panel-title">Players</div>
                    <div id="playersList" class="players-wrap max-h-[32rem] overflow-auto pr-1"></div>
                </section>
                <section class="panel">
                    <div class="panel-title">Bingo Calls</div>
                    <div id="bingoCalls" class="space-y-2 max-h-[32rem] overflow-auto pr-1"></div>
                </section>
            </aside>

            <!-- CENTER: Card -->
            <main class="xl:col-span-5">
                <div class="panel">
                    <div class="panel-title flex items-center gap-2">
                        <span>Your Card</span>
                        <span class="chip-hidden sm:inline-flex text-xs">Click tiles to toggle your mark</span>
                    </div>

                    <div id="card" class="mt-3 grid grid-cols-5 gap-2"></div>

                    <div class="flex items-center gap-2 mt-4 flex-wrap">
                        <button id="callBingoBtn" class="btn-primary ripple">Call Bingo</button>
                        <button id="autoPlayBtn" class="btn-outline ripple">Auto Play: OFF</button>
                        <button id="clearCardBtn" class="btn-danger ripple">Clear Card</button>
                        <button id="resetGameBtn" class="btn-danger ripple">Reset Game</button>
                        <span class="text-xs text-slate-500 flex items-center gap-2">
                            <span class="legend legend-yellow"></span> you marked
                            <span class="legend legend-green"></span> called + marked
                            <span class="legend legend-red"></span> called (not marked)
                        </span>
                    </div>
                </div>
            </main>

            <!-- RIGHT: Called + Available -->
            <aside class="xl:col-span-4">
                <div class="grid grid-cols-2 gap-4">
                    <section class="panel ring-green-50 border-green-200">
                        <div class="panel-title">Called</div>
                        <div id="calledList" class="space-y-1 max-h-[70vh] overflow-auto pr-1"></div>
                    </section>
                    <section class="panel">
                        <div class="panel-title">Available</div>
                        <div id="availableList" class="space-y-1 max-h-[70vh] overflow-auto"></div>
                    </section>
                </div>
            </aside>
        </div>
    </div>
</div>

<!-- Reset confirm modal -->
<div id="resetConfirmModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-50" role="dialog" aria-modal="true" aria-labelledby="resetConfirmTitle">
    <div class="bg-white rounded-xl shadow-xl p-6 w-80">
        <h2 id="resetConfirmTitle" class="font-semibold text-lg mb-3">Reset Game?</h2>
        <p class="text-sm text-slate-600 mb-4">This will reset the game for <b>ALL</b> players. Hold the button below to confirm.</p>
        <div class="flex justify-end gap-2">
            <button id="cancelResetBtn" class="btn-outline">Cancel</button>
            <button id="confirmResetBtn" class="btn-danger hold-btn" aria-label="Hold to confirm reset">Hold to Confirm</button>
        </div>
    </div>
</div>

<!-- Confetti canvas -->
<canvas id="confetti" class="pointer-events-none fixed inset-0 w-full h-full hidden"></canvas>

<!-- socket.io (global) -->
<script>
    const script = document.createElement('script');
    script.src = '/socket.io/socket.io.js';
    script.onload = () => console.log('Socket.io loaded successfully.');
    script.onerror = () => console.error('Failed to load Socket.io. Please check the server.');
    document.head.appendChild(script);
</script>
<!-- Module entrypoint -->
<script type="module" src="/js/main.js"></script>
</body>
</html>
